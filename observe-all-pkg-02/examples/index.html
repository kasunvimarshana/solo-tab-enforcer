<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>observe-all Examples</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .box { width: 100px; height: 100px; background: lightblue; margin: 10px; }
    .hidden { display: none; }
  </style>
</head>
<body>

  <h1>observe-all Examples</h1>

  <section>
    <h2>1. Mutation Observer</h2>
    <div id="mutation-target">Original Content</div>
    <button id="mutation-btn">Change Content</button>
  </section>

  <section>
    <h2>2. Intersection Observer</h2>
    <div style="height: 150vh; background: #eee;">
      <div id="intersection-target" class="box">Watch Me</div>
    </div>
  </section>

  <section>
    <h2>3. Resize Observer</h2>
    <div id="resize-target" class="box">Resize Me</div>
    <button id="resize-btn">Toggle Size</button>
  </section>

  <section>
    <h2>4. Value Observer (Proxy)</h2>
    <button id="value-btn">Change Observed Value</button>
  </section>

  <section>
    <h2>5. Event Observer</h2>
    <button id="event-btn">Click Me</button>
  </section>

  <script type="module">
    import { observeMutations, observeIntersections, observeResizes, observeValue, observeEvent } from '../src/index.js';

    // 1. Mutation Observer Example
    const mutationTarget = document.getElementById('mutation-target');
    const mutationBtn = document.getElementById('mutation-btn');

    const disconnectMut = observeMutations(mutationTarget, (mutations) => {
      console.log('Mutation detected:', mutations);
    });

    mutationBtn.addEventListener('click', () => {
      mutationTarget.textContent = 'Content Changed at ' + new Date().toLocaleTimeString();
    });

    // 2. Intersection Observer Example
    const intersectionTarget = document.getElementById('intersection-target');

    const disconnectInt = observeIntersections(intersectionTarget, (entries) => {
      entries.forEach(entry => {
        console.log('Intersection observed:', entry.isIntersecting);
        if (entry.isIntersecting) {
          entry.target.style.background = 'lightgreen';
        } else {
          entry.target.style.background = 'lightblue';
        }
      });
    });

    // 3. Resize Observer Example
    const resizeTarget = document.getElementById('resize-target');
    const resizeBtn = document.getElementById('resize-btn');

    const disconnectResize = observeResizes(resizeTarget, (entries) => {
      for (let entry of entries) {
        console.log('Resize observed:', entry.contentRect.width, entry.contentRect.height);
      }
    });

    let toggled = false;
    resizeBtn.addEventListener('click', () => {
      toggled = !toggled;
      resizeTarget.style.width = toggled ? '200px' : '100px';
      resizeTarget.style.height = toggled ? '200px' : '100px';
    });

    // 4. Value Observer Example
    const observedObj = { count: 0 };
    const proxyObj = observeValue(observedObj, 'count', (newValue) => {
      console.log('Value changed:', newValue);
    });

    const valueBtn = document.getElementById('value-btn');
    valueBtn.addEventListener('click', () => {
      proxyObj.count += 1;
    });

    // 5. Event Observer Example
    const eventBtn = document.getElementById('event-btn');

    const disconnectEvent = observeEvent(eventBtn, 'click', () => {
      console.log('Event observed: Button clicked');
      eventBtn.textContent = 'Clicked at ' + new Date().toLocaleTimeString();
    });

    // Example cleanup usage (optional demonstration)
    // setTimeout(() => {
    //   disconnectMut();
    //   disconnectInt();
    //   disconnectResize();
    //   disconnectEvent();
    //   console.log('All observers disconnected');
    // }, 60000); // disconnect after 1 minute
  </script>

</body>
</html>
